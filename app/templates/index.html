{% extends 'base.html' %}
{% block content %}
  <section class="space-y-6">
    <div class="rounded-2xl bg-white p-8 border border-gray-200 shadow-sm">
      <h1 class="text-3xl md:text-4xl font-bold tracking-tight">Conecte professores de direção e alunos</h1>
      <p class="mt-3 text-gray-700">Cadastre-se para oferecer serviços como tutor de direção ou para aprender.</p>
      {% if not current_user.is_authenticated %}
        <div class="mt-6 flex flex-col sm:flex-row gap-3">
          <a class="px-5 py-2.5 bg-yellow-400 text-black rounded-lg font-medium hover:bg-yellow-300 transition" href="{{ url_for('auth.register') }}">Cadastrar</a>
          <a class="px-5 py-2.5 bg-gray-200 text-gray-900 rounded-lg font-medium hover:bg-gray-300 transition" href="{{ url_for('auth.login') }}">Entrar</a>
        </div>
      {% else %}
        <a class="mt-6 inline-block px-5 py-2.5 bg-yellow-400 text-black rounded-lg font-medium hover:bg-yellow-300 transition" href="{{ url_for('main.profile') }}">Ir para o perfil</a>
      {% endif %}
    </div>
    <div class="rounded-2xl bg-white p-6 border border-gray-200">
      <h2 class="text-xl font-semibold mb-3">Relatos de pessoas satisfeitas</h2>
      <div id="carousel" class="relative">
        <div class="overflow-hidden rounded-xl relative min-h-[160px]">
          {% for t in testimonials %}
          <div class="slide absolute inset-0 transition-opacity duration-500 {% if loop.index0 == 0 %}opacity-100{% else %}opacity-0{% endif %}">
            <div class="p-4">
              <p class="text-gray-900 text-lg">“{{ t.text }}”</p>
              <div class="mt-2 text-sm text-gray-700">{{ t.name }}{% if t.city %} • {{ t.city }}{% endif %}</div>
            </div>
          </div>
          {% endfor %}
        </div>
        <div class="flex items-center justify-between mt-3">
          <div class="flex items-center gap-2">
            {% for t in testimonials %}
            <button class="dot h-2.5 w-2.5 rounded-full bg-gray-300" data-idx="{{ loop.index0 }}"></button>
            {% endfor %}
          </div>
          <div class="flex items-center gap-2">
            <button id="prev" class="px-3 py-1.5 bg-gray-200 text-gray-900 rounded hover:bg-gray-300 transition">Anterior</button>
            <button id="next" class="px-3 py-1.5 bg-yellow-400 text-black rounded hover:bg-yellow-300 transition">Próximo</button>
          </div>
        </div>
      </div>
    </div>
  </section>
  <script>
    const slides = Array.from(document.querySelectorAll('#carousel .slide'))
    const dots = Array.from(document.querySelectorAll('#carousel .dot'))
    let idx = 0
    function show(i){
      slides.forEach((s,j)=>{s.classList.toggle('opacity-100', j===i); s.classList.toggle('opacity-0', j!==i)})
      dots.forEach((d,j)=>{d.classList.toggle('bg-gray-300', j!==i); d.classList.toggle('bg-yellow-400', j===i)})
      idx = i
    }
    function next(){ show((idx+1)%slides.length) }
    function prev(){ show((idx-1+slides.length)%slides.length) }
    document.getElementById('next').addEventListener('click', next)
    document.getElementById('prev').addEventListener('click', prev)
    dots.forEach(d=>d.addEventListener('click', e=>show(parseInt(e.currentTarget.dataset.idx))))
    let timer = setInterval(next, 5000)
    document.getElementById('carousel').addEventListener('mouseenter', ()=>clearInterval(timer))
    document.getElementById('carousel').addEventListener('mouseleave', ()=>{timer = setInterval(next, 5000)})
  </script>
{% endblock %}
